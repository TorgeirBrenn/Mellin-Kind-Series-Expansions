%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%laguerrefast : faster (non-symbolic) version of laguerreL with same
%inputs, but limited to N <= 8.
%
%l = laguerrefast(N,a,x) mimics the function of laguerreL(), but is limited
%to N<=8. The 8 first generalised polynomials are explicitly written in
%this function.
%
%INPUT
%N : Order of the Laguerre polynomial.
%a : Coefficient of the Laguerre polynomial. 
%x : Datapoints on which the Laguerre polynomial should be evaluated.
%
%OUTPUT
%l : The functional value of the Laguerre polynomial.
%
%Last update: 2017-02-22
%Made by Torgeir Brenn
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


function l = laguerrefast(N,a,x)
    
    switch N
        case 0
            l = ones(size(x));
        case 1
            l = a - x + 1;
        case 2
            l = 3*a/2 - x*(a + 2) + a^2/2 + x.^2/2 + 1;
        case 3
            l = (11*a)/6 - x*(a^2/2 + (5*a)/2 + 3) + x.^2*(a/2 + 3/2) ...
                + a^2 + a^3/6 - x.^3/6 + 1;
        case 4
            l = (25*a)/12 - x*(a^3/6 + (3*a^2)/2 + (13*a)/3 + 4) ...
                - x.^3*(a/6 + 2/3) + x.^2*(a^2/4 + (7*a)/4 + 3) ...
                + (35*a^2)/24 + (5*a^3)/12 + a^4/24 + x.^4/24 + 1;
        case 5
            l = (137*a)/60 + x.^2*(a^3/12 + a^2 + (47*a)/12 + 5) ...
                + x.^4*(a/24 + 5/24) - x*(a^4/24 + (7*a^3)/12 ...
                + (71*a^2)/24 + (77*a)/12 + 5) ...
                - x.^3*(a^2/12 + (3*a)/4 + 5/3) + (15*a^2)/8 ...
                + (17*a^3)/24 + a^4/8 + a^5/120 - x.^5/120 + 1;
        case 6
            l = (49*a)/20 - x.^5*(a/120 + 1/20) ...
                + x.^4*(a^2/48 + (11*a)/48 + 5/8) ...
                - x*(a^5/120 + a^4/6 + (31*a^3)/24 ...
                + (29*a^2)/6 + (87*a)/10 + 6) ...
                - x.^3*(a^3/36 + (5*a^2)/12 + (37*a)/18 + 10/3) ...
                + x.^2*(a^4/48 + (3*a^3)/8 + (119*a^2)/48 ...
                + (57*a)/8 + 15/2) + (203*a^2)/90 + (49*a^3)/48 ...
                + (35*a^4)/144 + (7*a^5)/240 + a^6/720 + x.^6/720 + 1;
        case 7
            l = (363*a)/140 + x.^6*(a/720 + 7/720) - x.^5*(a^2/240 + ...
                (13*a)/240 + 7/40) + x.^4*(a^3/144 + a^2/8 + ...
                (107*a)/144 + 35/24) - x.*(a^6/720 + (3*a^5)/80 + ...
                (59*a^4)/144 + (37*a^3)/16 + (319*a^2)/45 + ...
                (223*a)/20 + 7) - x.^3*(a^4/144 + (11*a^3)/72 + ...
                (179*a^2)/144 + (319*a)/72 + 35/6) + (469*a^2)/180 + ...
                (967*a^3)/720 + (7*a^4)/18 + (23*a^5)/360 + a^6/180 + ...
                a^7/5040 + x.^2*(a^5/240 + (5*a^4)/48 + (49*a^3)/48 + ...
                (235*a^2)/48 + (459*a)/40 + 21/2) - x.^7/5040 + 1;
        case 8
            l = (761*a)/280 - x.^7*(a/5040 + 1/630) + x.^6*(a^2/1440 + ...
                a/96 + 7/180) - x.^5*(a^3/720 + (7*a^2)/240 + ...
                (73*a)/360 + 7/15) + x.^4*(a^4/576 + (13*a^3)/288 + ...
                (251*a^2)/576 + (533*a)/288 + 35/12) - x.*(a^7/5040 + ...
                a^6/144 + (73*a^5)/720 + (115*a^4)/144 + (329*a^3)/90 + ...
                (349*a^2)/36 + (481*a)/35 + 8) + (29531*a^2)/10080 + ...
                (267*a^3)/160 + (1069*a^4)/1920 + (9*a^5)/80 + ...
                (13*a^6)/960 + a^7/1120 + a^8/40320 - x.^3*(a^5/720 + ...
                a^4/24 + (71*a^3)/144 + (23*a^2)/8 + (743*a)/90 + ...
                28/3) + x.^8/40320 + x.^2*(a^6/1440 + (11*a^5)/480 + ...
                (89*a^4)/288 + (209*a^3)/96 + (6077*a^2)/720 + ...
                (341*a)/20 + 14) + 1;
        otherwise
            disp 'ERROR: N must take an integer value in {0,...,8}'
    end
end